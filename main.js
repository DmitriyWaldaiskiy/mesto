(()=>{"use strict";const t=document.querySelector(".profile__button"),e=document.querySelector(".profile__add-button"),s=document.querySelector(".profileForm"),i=document.querySelector(".addform"),r={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-submit",inactiveButtonClass:"popup__button-submit_off",inputErrorClass:"popup__input_invalid",errorClass:"popup__input-error"};class o{constructor(t,e,s){this._cardData=t,this._openImage=s,this._cardElement=document.querySelector(e).content.querySelector(".element").cloneNode(!0)}_handleDelete=()=>{this._cardElement.remove()};_handleLike=()=>{this._likeButton.classList.toggle("element__like_active")};_onOpenImage=()=>{this._openImage(this._cardData)};_setEventListener=()=>{this._deleteButton.addEventListener("click",this._handleDelete),this._likeButton.addEventListener("click",this._handleLike),this._cardImage.addEventListener("click",this._onOpenImage)};createCardElement=()=>(this._cardImage=this._cardElement.querySelector(".element__images"),this._cardName=this._cardElement.querySelector(".element__heading"),this._deleteButton=this._cardElement.querySelector(".element__button-delete"),this._likeButton=this._cardElement.querySelector(".element__like"),this._cardImage.src=this._cardData.link,this._cardImage.alt=this._cardData.place,this._cardName.textContent=this._cardData.place,this._setEventListener(),this._cardElement)}class n{constructor(t,e){this._form=e,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector)}_showError=t=>{this._errorElement=this._form.querySelector(`.${t.id}-error`),t.classList.add(this._inputErrorClass),this._errorElement.textContent=t.validationMessage,this._errorElement.classList.add(this._errorClass)};_hideError=t=>{this._errorElement=this._form.querySelector(`.${t.id}-error`),t.classList.remove(this._inputErrorClass),this._errorElement.classList.remove(this._errorClass),this._errorElement.textContent=""};_checkInputValidity=t=>{t.validity.valid?this._hideError(t):this._showError(t)};_hasInvalidInput=()=>this._inputList.some((t=>!t.validity.valid));_deactivateButton=()=>{this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)};_activateButton=()=>{this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!0)};_toggleButtonState=()=>{this._hasInvalidInput()?this._deactivateButton():this._activateButton()};_setEventListeners=()=>{this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))};enableValidation=()=>{this._form.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()};resetError=()=>{this._deactivateButton()}}class a{constructor(t){this._popup=document.querySelector(t),this._popupCloseBtn=this._popup.querySelector(".popup__close-icon")}_handleEsc=t=>{"Escape"===t.key&&this.close()};_handleCloseBtn=()=>{this.close()};_handleOverlay=t=>{t.target===t.currentTarget&&this.close()};setEventListeners(){this._popupCloseBtn.addEventListener("click",this._handleCloseBtn),this._popup.addEventListener("click",this._handleOverlay)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEsc)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEsc)}}class l extends a{constructor(t,e){super(t),this._functionSubmit=e,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input")}_getInputsValue(){return this._values={},this._inputList.forEach((t=>{this._values[t.name]=t.value})),this._values}setInputsValue(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._functionSubmit(this._getInputsValue()),this.close()}))}close(){super.close(),this._form.reset()}}const p=new class{constructor(t){this._profileName=document.querySelector(t.profileNameSelector),this._profileJob=document.querySelector(t.profileJobSelector)}getUserInfo(){return{username:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(t){this._profileName.textContent=t.username,this._profileJob.textContent=t.job}}({profileNameSelector:".profile__title",profileJobSelector:".profile__subtitle"}),c=new class extends a{constructor(t){super(t),this._popupImage=this._popup.querySelector(".popup__image"),this._imageCaption=this._popup.querySelector(".popup__caption-image")}open=t=>{this._popupImage.src=t.link,this._popupImage.alt=t.place,this._imageCaption.textContent=`На фото ${t.place}`,super.open()}}(".popup_image-zoom"),u=new class{constructor({items:t,renderer:e},s){this._container=document.querySelector(s),this._initialCards=t,this._renderer=e}addCards(){this._initialCards.forEach((t=>{this.addItem(t)}))}addItem(t){this._container.prepend(this._renderer(t))}}({items:[{place:"Звездное небо",link:"https://images.unsplash.com/photo-1680742376777-3f66cc33513b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=464&q=80"},{place:"Дорога в лесу",link:"https://images.unsplash.com/photo-1680158239346-8d2eb947ac52?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=327&q=80"},{place:"Елка",link:"https://images.unsplash.com/photo-1679775912575-cfe09ff563b8?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1965&q=80"},{place:"Лес",link:"https://images.unsplash.com/photo-1677485449555-5df4c23d6ea3?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=369&q=80"},{place:"Шишка",link:"https://images.unsplash.com/photo-1659891169235-9fc4ed6d0f9a?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80"},{place:"Олень",link:"https://images.unsplash.com/photo-1676579533885-61b1d0d8a094?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=394&q=80"}],renderer:t=>new o(t,".cards-template",c.open).createCardElement()},".elements"),_=new l(".popup_profile",(t=>{p.setUserInfo(t)}));t.addEventListener("click",(()=>{_.setInputsValue(p.getUserInfo()),_.open()}));const h=new l(".popup_add",(t=>{u.addItem(t)}));e.addEventListener("click",(()=>{d.resetError(),h.open()})),_.setEventListeners(),c.setEventListeners(),h.setEventListeners(),u.addCards(),new n(r,s).enableValidation();const d=new n(r,i);d.enableValidation()})();